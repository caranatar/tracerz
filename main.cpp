#include "tracerz.h"
#include "catch.hpp"

int main()
{
    //tracerz::Grammar zgr("{\"animal\": [\"unicorn\",\"raven\",\"sparrow\",\"scorpion\",\"coyote\",\"eagle\",\"owl\",\"lizard\",\"zebra\",\"duck\",\"kitten\"], \"origin\":\"#animal#\" }"_json);
    //tracerz::Grammar zgr("{\"noun1\":[\"cloud\", \"wave\", \"bird\", \"boat\", \"ship\", \"horse\", \"horn\", \"helm\", \"cat\", \"dude\", \"blade\", \"knife\", \"sword\", \"axe\", \"fish\", \"spear\", \"shield\", \"mount\", \"cow\", \"field\", \"man\", \"hound\", \"dog\", \"sheep\", \"eye\", \"key\", \"book\", \"phone\", \"tweet\", \"coin\", \"bed\", \"lamp\", \"torch\", \"egg\", \"cake\", \"gif\", \"child\", \"boy\", \"girl\", \"man\", \"friend\", \"tea\", \"wood\", \"food\", \"drink\", \"shoe\", \"dork\", \"nerd\", \"mom\", \"dad\", \"stake\", \"urn\", \"game\", \"gun\", \"pen\", \"porn\", \"soap\", \"brick\", \"lard\", \"rice\", \"wind\", \"ice\", \"earth\", \"heart\", \"mind\", \"plaid\", \"rock\", \"ska\", \"rap\", \"love\", \"fire\", \"owl\", \"shark\", \"hoop\", \"cloak\", \"cape\", \"mouse\", \"screw\", \"bolt\", \"guy\", \"gal\", \"spy\", \"foe\", \"bum\", \"Elf\", \"Dwarf\", \"Orc\", \"pig\", \"cop\", \"bitch\", \"jerk\", \"ass\", \"quiz\", \"test\", \"class\", \"job\", \"farm\", \"harp\", \"tarp\", \"carp\", \"god\", \"sand\", \"dirt\", \"sweat\", \"blood\", \"snot\", \"hat\", \"bag\", \"hook\", \"door\", \"lock\", \"pit\", \"rake\", \"church\", \"light\", \"sun\", \"moon\", \"star\", \"pad\", \"thread\", \"plant\", \"bell\", \"car\", \"stone\", \"tooth\", \"grape\", \"lad\", \"lass\", \"skunk\", \"pie\", \"clock\", \"pain\", \"bat\", \"smell\", \"sound\", \"taste\", \"touch\", \"sight\", \"weed\", \"hair\", \"bee\"],\"noun2\":[\"eagle\", \"rider\", \"hauberk\", \"pirate\", \"antler\", \"armor\", \"blacksmith\", \"shovel\", \"monkey\", \"baker\", \"butcher\", \"dagger\", \"llama\", \"dragon\", \"chaos\", \"father\", \"mother\", \"sister\", \"brother\", \"cousin\", \"granny\", \"Buddha\", \"ninja\", \"Waldo\", \"pizza\", \"off switch\", \"notebook\", \"paper\",\"ballot\", \"mirror\", \"garlic\", \"master\", \"vampire\", \"werewolf\", \"silver\", \"toadstool\", \"money\", \"exit\", \"bullet\",  \"spider\", \"kinsman\", \"dudebro\", \"comrade\", \"hedgehog\", \"shepard\", \"email\", \"dollar\", \"milkshake\", \"apple\", \"fighter\", \"wizard\", \"cleric\", \"water\", \"candy\", \"fire\", \"iron\", \"robot\", \"root beer\", \"manga\", \"sci-fi\", \"sickle\", \"coffee\", \"shoebill\", \"turtle\", \"jpeg\", \"hammer\", \"button\", \"taco\", \"pencil\", \"toothpaste\", \"GameBoy\", \"banjo\", \"baby\", \"doggo\", \"kitten\", \"soapbox\", \"disco\", \"velcro\",\"tie-dye\", \"kindness\", \"carpet\", \"sandwich\", \"8-track\", \"reggae\",  \"#my# wife\", \"bathroom\", \"elbow\", \"dolphin\", \"thunder\", \"lightning\", \"bauble\", \"Frenchman\", \"German\", \"tour bus\", \"frisbee\", \"joystick\" ],\"verb\":[\"flowing\", \"blowing\", \"showing\", \"growing\", \"glowing\", \"throwing\", \"mowing\", \"rowing\", \"stowing\", \"sleeping\", \"eating\", \"killing\", \"winning\", \"losing\", \"playing\", \"drawing\", \"falling\", \"talking\", \"reading\", \"tweeting\", \"voting\", \"pooping\", \"blooming\", \"leaping\", \"dancing\", \"singing\", \"feasting\", \"flying\", \"digging\", \"working\", \"coding\", \"napping\", \"learning\", \"teaching\", \"painting\", \"speaking\", \"hearing\", \"cracking\", \"breaking\", \"mending\", \"barking\", \"gleaming\", \"shining\", \"humming\", \"pulsing\", \"dripping\", \"sighing\", \"dying\", \"climbing\", \"running\", \"biting\", \"fighting\", \"poking\", \"cleaning\", \"peeing\", \"walking\", \"waiting\", \"thinking\", \"learning\", \"leering\", \"ringing\", \"burning\", \"rusting\", \"holding\", \"faking\", \"molding\", \"rotting\", \"sinking\", \"drifting\", \"holding\",\"folding\", \"helping\", \"lying\", \"hurting\", \"aching\", \"dreaming\", \"resting\", \"coming\", \"leaving\", \"hoping\",  \"ageing\", \"aching\", \"charging\", \"grooming\", \"crashing\", \"twisting\"],\"ground1\":[\"hills\", \"vales\", \"seas\", \"trees\", \"woods\", \"roads\", \"paths\", \"mounds\", \"fields\", \"swamps\", \"homes\", \"towns\", \"lands\", \"holes\", \"tombs\", \"wells\", \"lakes\", \"caves\", \"walls\", \"drapes\", \"screens\", \"glass\", \"clouds\", \"rains\", \"mists\", \"stars\", \"skies\", \"coves\", \"dams\", \"dark\", \"dales\", \"nights\", \"days\", \"cars\", \"myths\", \"tears\", \"hopes\", \"spires\", \"nests\", \"peaks\", \"rifts\", \"gaps\", \"glens\", \"dells\", \"knolls\", \"mounds\", \"plains\", \"velds\", \"steppes\", \"crags\"],\"ground2\":[\"in the #ground2in#\", \"on the #ground2on#\"],\"ground2in\":[\"river\", \"valley\",\"ocean\", \"meadow\", \"forest\", \"mountains\", \"shadows\", \"canyons\", \"city\", \"burrows\", \"chatrooms\",\"evening\", \"summer\", \"autumn\", \"winter\", \"morning\", \"bathroom\", \"courtyard\", \"bedroom\", \"drive through\", \"twilight\", \"darkness\", \"rainbows\", \"wetlands\", \"marshes\", \"break room\", \"classroom\", \"courtroom\", \"castle\", \"phone book\", \"mansion\",\"skatepark\", \"churchyard\", \"condo\", \"Stone Age\", \"spaceship\", \"country\", \"boondocks\",  \"old shed\", \"top ten\", \"big tent\", \"old days\", \"lowland\", \"prairie\", \"pasture\", \"grassland\", \"basin\", \"ravine\", \"outpost\", \"mosh pit\", \"crater\", \"basement\", \"attic\", \"crawl space\"],\"ground2on\":[\"river\", \"ocean\", \"mountain\", \"hillside\", \"toilet\", \"sidewalk\", \"airplane\", \"school bus\", \"dark web\", \"beach towel\", \"West coast\", \"East Coast\", \"south side\", \"north side\", \"flip side\", \"bike path\", \"hilltop\", \"Dark Side\", \"boardwalk\", \"tow truck\", \"tugboat\", \"sofa\", \"tower\", \"bike ramp\", \"old road\", \"highway\", \"way out\", \"back porch\", \"front stoop\", \"old throne\", \"hillock\", \"mesa\", \"rooftop\", \"ceiling\", \"terrace\", \"platform\", \"catwalk\", \"see-saw\", \"launchpad\", \"runway\"],\"substance1\":[\"joy\", \"mist\", \"fog\", \"glass\", \"rain\", \"dew\", \"clouds\", \"sun\", \"gold\", \"light\", \"love\", \"grace\", \"friends\", \"hope\", \"cheer\", \"wind\", \"breeze\", \"time\", \"dreams\", \"youth\", \"days\", \"nights\", \"spring\", \"snow\", \"songs\", \"luck\", \"dusk\", \"owls\", \"snails\", \"bats\", \"screams\", \"tears\", \"sighs\", \"wails\", \"rats\", \"thoughts\", \"ants\", \"worms\", \"dust\", \"farts\", \"gnats\", \"fear\", \"warmth\", \"thoughts\", \"fire\", \"rains\", \"winds\", \"wrath\", \"sparks\", \"cars\", \"bikes\", \"ships\", \"cats\"],\"substance2\":[\"shadow\", \"terror\", \"silence\", \"darkness\", \"twilight\", \"sadness\", \"gladness\", \"sorrow\", \"quiet\", \"silver\", \"rainbows\", \"reruns\", \"mucus\", \"madness\", \"slumber\", \"despair\", \"danger\", \"the West\", \"the East\", \"the North\", \"the South\", \"the grave\", \"the end\", \"#my# dreams\", \"#my# grave\", \"nothing\", \"always\", \"never\", \"the past\", \"the night\", \"night time\", \"bed time\", \"big mood\", \"old tales\", \"stories\", \"sagas\", \"legend\", \"the myths\", \"the #substance1#\", \"pine straw\", \"seaweed\", \"#my# #substance1#\", \"error\", \"butter\", \"lava\", \"hummus\", \"oceans\", \"limbo\"],\"my\":[\"my\", \"our\", \"their\", \"his\", \"her\", \"its\", \"your\", \"the\", \"a\"],\"heaven\":[\"the West\", \"Heaven\", \"Asgard\", \"the East\", \"the North\", \"the South\", \"#my# home\", \"the lands\", \"#my# world\", \"this world\", \"these lands\", \"#my# dreams\", \"#my# heart\", \"the dust\", \"their graves\", \"ashes\",  \"#propernoun2#\", \"Old Earth\", \"Terra\"],\"propernoun2\":[\"Boston\", \"New York\", \"Tampa\", \"Portland\", \"China\", \"Japan\", \"Taiwan\", \"Utah\", \"Texas\", \"Poland\", \"Russia\", \"Egypt\", \"Cuba\", \"Vermont\", \"my house\", \"Thailand\", \"L.A.\", \"Brazil\", \"Two Egg\", \"Taipei\", \"Tokyo\", \"Paris\", \"Berlin\", \"Oslo\", \"Norway\", \"Sweden\", \"Denmark\", \"Iceland\", \"Greenland\", \"Kenya\", \"Venus\", \"Saturn\", \"Pluto\", \"Eris\", \"Yilan\", \"Dallas\", \"SeaWorld\", \"Bangkok\", \"Hanoi\"],\"behind\":[\"behind\", \"beyond\", \"far past\", \"around\", \"before\", \"beside\", \"between\", \"below\", \"above\", \"after\"],\"line1\":[\"Where is the #noun1# and the #noun2#?\"],\"line2\":[\"Where is the #noun1# that was #verb#?\"],\"line3\":[\"They have passed like #substance1# #ground2#, like #substance1# #ground2#;\"],\"line4\":[\"The days have gone down in #heaven# #behind# the #ground1# into #substance2#.\"],\"poem\":[\"#line1#\\n#line2#\\n#line3#\\n#line4#\\n\\nHow did it come to this?\"],\"origin\":[\"#[x:#line1#]poem#\"]}"_json);
    //tracerz::Grammar zgr("{\"foo\": \"#animal#\", \"animal\": \"zedbra\", \"origin\": \"#[x:#foo#]x#\"}"_json);
    //tracerz::Grammar zgr("{\"name\": [\"Arjun\",\"Yuuma\",\"Darcy\",\"Mia\",\"Chiaki\",\"Izzi\",\"Azra\",\"Lina\"],	\"animal\": [\"unicorn\",\"raven\",\"sparrow\",\"scorpion\",\"coyote\",\"eagle\",\"owl\",\"lizard\",\"zebra\",\"duck\",\"kitten\"],	\"mood\": [\"vexed\",\"indignant\",\"impassioned\",\"wistful\",\"astute\",\"courteous\"],	\"story\": [\"#hero# traveled with her pet #heroPet#.  #hero# was never #mood#, for the #heroPet# was always too #mood#.\"],	\"origin\": [\"#[hero:#name#][heroPet:#animal#]story#\"]}"_json);
    tracerz::Grammar zgr("{	\"name\": [\"Arjun\",\"Yuuma\",\"Darcy\",\"Mia\",\"Chiaki\",\"Izzi\",\"Azra\",\"Lina\"],	\"animal\": [\"unicorn\",\"raven\",\"sparrow\",\"scorpion\",\"coyote\",\"eagle\",\"owl\",\"lizard\",\"zebra\",\"duck\",\"kitten\"],	\"occupationBase\": [\"wizard\",\"witch\",\"detective\",\"ballerina\",\"criminal\",\"pirate\",\"lumberjack\",\"spy\",\"doctor\",\"scientist\",\"captain\",\"priest\"],	\"occupationMod\": [\"occult \",\"space \",\"professional \",\"gentleman \",\"erotic \",\"time \",\"cyber\",\"paleo\",\"techno\",\"super\"],	\"strange\": [\"mysterious\",\"portentous\",\"enchanting\",\"strange\",\"eerie\"],	\"tale\": [\"story\",\"saga\",\"tale\",\"legend\"],	\"occupation\": [\"#occupationMod##occupationBase#\"],	\"mood\": [\"vexed\",\"indignant\",\"impassioned\",\"wistful\",\"astute\",\"courteous\"],	\"setPronouns\": [\"[heroThey:they][heroThem:them][heroTheir:their][heroTheirs:theirs]\",\"[heroThey:she][heroThem:her][heroTheir:her][heroTheirs:hers]\",\"[heroThey:he][heroThem:him][heroTheir:his][heroTheirs:his]\"],	\"setSailForAdventure\": [\"set sail for adventure\",\"left #heroTheir# home\",\"set out for adventure\",\"went to seek #heroTheir# forture\"],	\"setCharacter\": [\"[#setPronouns#][hero:#name#][heroJob:#occupation#]\"],	\"openBook\": [\"An old #occupation# told #hero# a story. 'Listen well' she said to #hero#, 'to this #strange# #tale#. ' #origin#'\",\"#hero# went home.\",\"#hero# found an ancient book and opened it.  As #hero# read, the book told #strange.a# #tale#: #origin#\"],	\"story\": [\"#hero# the #heroJob# #setSailForAdventure#. #openBook#\"],	\"origin\": [\"Once upon a time, #[#setCharacter#]story#\"]}"_json);

    zgr.addModifiers(tracerz::Grammar::getBaseEngModifiers());
    auto tree = zgr.getTree("#origin#");
    do
    {
    }
    while(tree->expand(zgr.getModifierFunctions()));

    std::cout << tree->flatten(zgr.getModifierFunctions()) << std::endl;

    return 0;
}
